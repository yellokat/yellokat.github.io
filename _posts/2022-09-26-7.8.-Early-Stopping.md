---
math: true
title: "[DL Book] 7-8. Early Stopping"
categories:
  - Deep Learning Book
tags:
  - Books
  - Deep Learning Book
  - Regularization
  - Statistics
  - Study Group
---

# 7.8. Early Stopping
ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ë‹¤ ë³´ë©´, í›ˆë ¨ ì˜¤ì°¨ìœ¨ì€ ê³„ì†í•´ì„œ ë‚´ë ¤ê°€ì§€ë§Œ ê²€ì¦ ì˜¤ì°¨ìœ¨ì€ ì–´ëŠ ì§€ì ì„ ë„˜ì–´ì„œë©´ ë” ì´ìƒ ë‚´ë ¤ê°€ì§€ ì•Šê³  ê±°ê¾¸ë¡œ ì˜¬ë¼ê°€ê¸°ê¹Œì§€ í•œë‹¤. ì´ê²ƒì€ ëª¨ë¸ì´ í›ˆë ¨ ë°ì´í„°ì— ëŒ€í•´ ì˜¤ë²„í”¼íŒ…ë˜ê³  ì¼ë°˜í™” ì„±ëŠ¥ì„ ìƒê¸° ë•Œë¬¸ì´ë‹¤.

![Untitled](/assets/images/dlbook/7/6.png)

ê·¸ë ‡ë‹¤ë©´ ìš°ë¦¬ëŠ” ê´€ì¸¡ëœ ê²€ì¦ ì˜¤ì°¨ìœ¨ì´ ê°€ì¥ ë‚®ì€ ì‹œì ìœ¼ë¡œ ë˜ëŒì•„ê°€ ê·¸ ë•Œì˜ ëª¨ë¸ì´ ìµœê³ ë¼ê³  ì„ ì–¸í•  ìˆ˜ ìˆë‹¤. ì—”ì§€ë‹ˆì–´ë§ì ì¸ ì¸¡ë©´ì—ì„œ, ì´ê²ƒì€ ìµœì†Œ ê²€ì¦ ì˜¤ì°¨ìœ¨ì´ ê°±ì‹ ë  ë•Œë§ˆë‹¤ ê·¸ ì‹œì ì˜ ëª¨ë¸ ê°€ì¤‘ì¹˜ë¥¼ ë³„ë„ë¡œ ì €ì¥í•œ ë’¤, í•™ìŠµì´ ì¢…ë£Œëœ í›„ ê°€ì¥ ë§ˆì§€ë§‰ìœ¼ë¡œ ì €ì¥ëœ ëª¨ë¸ ê°€ì¤‘ì¹˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ êµ¬í˜„ì´ ê°€ëŠ¥í•˜ë‹¤.

ì´ ì „ëµì„ ì¡°ê¸° ì¢…ë£Œ(Early Stopping)ë¼ê³  ë¶€ë¥´ë©°, ê·¸ ê°„ë‹¨í•¨ê³¼ ê°•ë ¥í•¨ ë•ë¶„ì— ê°€ì¥ ëŒ€ì¤‘í™”ëœ ì •ì¹™í™” ê¸°ë²• ì¤‘ í•˜ë‚˜ì´ë‹¤.

### ì¥ì 

- **ë§¤ìš° íš¨ìœ¨ì ì¸ í•˜ì´í¼íŒŒë¼ë¯¸í„° íƒìƒ‰**
í•™ìŠµì— ì‚¬ìš©ë˜ëŠ” ì—í­(Epoch) ìˆ«ìëŠ” ì–´ë–¤ ê´€ì ì—ì„œëŠ” í•˜ì´í¼íŒŒë¼ë¯¸í„°ì´ë‹¤. í•˜ì§€ë§Œ í›ˆë ¨ì„ ì—¬ëŸ¬ ë²ˆ í•´ì•¼ í•˜ëŠ” ì¼ë°˜ì ì¸ í•˜ì´í¼íŒŒë¼ë¯¸í„°ì™€ëŠ” ë°˜ëŒ€ë¡œ, ì—í­ ìˆ«ìëŠ” ë‹¨ í•œ ë²ˆì˜ í›ˆë ¨ìœ¼ë¡œ ìµœì ì˜ ì§€ì ì„ ì°¾ì•„ë‚¼ ìˆ˜ ìˆë‹¤.
- **í•™ìŠµ ê³¼ì •ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•ŠëŠ”ë‹¤.**
L2 ì •ì¹™í™” ë“±ì˜ ì „ëµì€ ëª¨ë¸ íŒŒë¼ë¯¸í„°ì˜ í•™ìŠµ ê³¼ì •ì— ìˆ˜ì¹˜ì ìœ¼ë¡œ ì˜í–¥ì„ ë¯¸ì¹œë‹¤. ë”°ë¼ì„œ ì˜ëª»ëœ ì •ì¹™í™” ì „ëµì„ ì„ íƒí•˜ë©´ ëª¨ë¸ì˜ ì„±ëŠ¥ì— ì•…ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆë‹¤. ë°˜ë©´ í•™ìŠµ ì¡°ê¸°ì¢…ë£ŒëŠ” ë„ì… ìœ ë¬´ì— ë”°ë¥¸ í•™ìŠµ ê³¼ì •ì˜ ë³€í™”ê°€ ì¼ì ˆ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.
- **ë‹¤ë¥¸ ì •ì¹™í™” ì „ëµê³¼ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.**
ì¡°ê¸°ì¢…ë£Œë¥¼ ì‚¬ìš©í•œë‹¤ê³  í•´ì„œ ë¬´ì¡°ê±´ ëª¨ë¸ì´ Global Minimumìœ¼ë¡œ ìˆ˜ë ´í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤. ë”°ë¼ì„œ ê¸°íƒ€ ì •ì¹™í™” ì „ëµê³¼ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ê¶Œì¥ë˜ëŠ”ë°, ëŒ€ë‹¤ìˆ˜ì˜ ì •ì¹™í™” ì „ëµì€ ì¡°ê¸°ì¢…ë£Œì™€ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤.

### ë‹¨ì 

- **ì£¼ê¸°ì ìœ¼ë¡œ ì¼ë°˜í™” ì„±ëŠ¥ í™•ì¸ì´ í•„ìš”í•˜ë‹¤.**
í•™ìŠµ ì¡°ê¸°ì¢…ë£ŒëŠ” $n$ ì—í­ë§ˆë‹¤ ê²€ì¦ ë°ì´í„°ì…‹ì„ ê¸°ë°˜ìœ¼ë¡œ ëª¨ë¸ì„ í‰ê°€í•˜ê³ , ê·¸ í‰ê°€ëœ ì„±ëŠ¥ì´ ë” ì´ìƒ ì„±ëŠ¥ì´ ì¦ê°€í•˜ì§€ ì•Šì„ ë•Œ í•™ìŠµì„ ë©ˆì¶”ì–´ì•¼ í•œë‹¤. ì´ ë•Œ, ëª¨ë¸ì„ í‰ê°€í•˜ëŠ” ê³¼ì •ì—ì„œ ì¶”ê°€ì ì¸ ì»´í“¨íŒ… ìì›ì˜ ì†Œëª¨ê°€ ë°œìƒí•œë‹¤.
    - **í•´ê²°ì±…** : ë³„ë„ì˜ ì¥ì¹˜ì—ì„œ ë³‘ë ¬ì ìœ¼ë¡œ ê²€ì¦ì„ ì§„í–‰í•  ìˆ˜ ìˆë‹¤. ì´ ê²½ìš° ì‹œê°„ì ì¸ ì—¬ìœ ê°€ í™•ë³´ë˜ë¯€ë¡œ ë” ì €ë ´í•œ ì¥ì¹˜(e.g. CPU)ë¥¼ ì‚¬ìš©í•´ë„ ì¢‹ë‹¤. ê²€ì¦ì„ ë³‘ë ¬ë¡œ ì§„í–‰í•  ìˆ˜ ì—†ë‹¤ë©´ ê²€ì¦ ë°ì´í„°ì…‹ì˜ í¬ê¸°ë¥¼ ì‘ê²Œ ì„¤ì •í•˜ëŠ” ë“±ìœ¼ë¡œ ì‹œê°„ ì†Œëª¨ë¥¼ ë‹¨ì¶•í•  ìˆ˜ ìˆë‹¤.
- **ëª¨ë¸ íŒŒë¼ë¯¸í„°ë¥¼ ê¸°ë¡í•˜ê¸° ìœ„í•œ ì €ì¥ê³µê°„ì´ ë³„ë„ë¡œ í•„ìš”í•˜ë‹¤.**
í•˜ì§€ë§Œ ì´ê²ƒì€ ì¼ë°˜ì ìœ¼ë¡œ í° ë¬¸ì œê°€ ë˜ì§€ ì•ŠëŠ”ë‹¤.
    - **í•´ê²°ì±…** : ì •ë§ë¡œ ìì›ì˜ íš¨ìœ¨ì ì¸ ë°°ë¶„ì´ ì¤‘ìš”í•˜ë‹¤ë©´, í•™ìŠµì— ì‚¬ìš©ë˜ëŠ” ê²ƒ(e.g. GPU ë©”ëª¨ë¦¬)ë³´ë‹¤ëŠ” ì €ë ´í•˜ê³  ëŠë¦° ì¥ì¹˜(e.g. CPU ë©”ëª¨ë¦¬, í•˜ë“œ ë””ìŠ¤í¬)ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤.
- **í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ ì´ì™¸ì— ê²€ì¦ ë°ì´í„°ì…‹ì´ í•„ìš”í•˜ë‹¤.**
ì´ê²ƒì€ ê¶ê·¹ì ìœ¼ë¡œ í•™ìŠµì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ê°€ ì ì–´ì§ì„ ì˜ë¯¸í•œë‹¤.
    - **í•´ê²°ì±… 1 :** í•™ìŠµ ì¡°ê¸°ì¢…ë£Œë¡œ ìµœì ì˜ ì—í­ ìˆ«ì $n$ì„ ì•Œì•„ë‚¸ ë’¤, ëª¨ë“  ë°ì´í„°ë¥¼ ê°€ì§€ê³  ë‹¤ì‹œ $n$ì—í­ë§Œí¼ í•™ìŠµí•œë‹¤. ë‹¨, ì…ë ¥ ë°ì´í„°ê°€ ë³€í–ˆê¸° ë•Œë¬¸ì— ì´ì „ê³¼ ë™ì¼í•˜ê²Œ ìµœì ì˜ ëª¨ë¸ì„ í•™ìŠµí• ì§€ëŠ” ì •í™•íˆ ì•Œ ìˆ˜ ì—†ë‹¤.
    - **í•´ê²°ì±… 2 :** í•™ìŠµì´ ì¡°ê¸°ì¢…ë£Œëœ ë’¤ í›ˆë ¨ ì˜¤ì°¨ë¥¼ ê³„ì‚°í•œë‹¤. ì´í›„ ê²€ì¦ ì˜¤ì°¨ê°€ í›ˆë ¨ ì˜¤ì°¨ ì•„ë˜ë¡œ ë‚´ë ¤ê°ˆ ë•Œê¹Œì§€, ì „ì²´ ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ í›ˆë ¨í•œë‹¤. ì´ ì•Œê³ ë¦¬ì¦˜ì€ ë§¤ìš° ë¶ˆì•ˆì •í•˜ë©° ìœ í•œ ì‹œê°„ ë‚´ì— ì¢…ë£Œë˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆë‹¤.
    
        {: .highlight }
        > \\
        > ğŸ’¡ **yellokatì˜ ë§:**\\
        > ì´ ë°©ë²•ì€ ì •ë§ ë“£ê¸°ë§Œ í•´ë„ ê·¸ì§€ê°™ì€ ë°©ë²•ì¸ë° ì´ê²Œ ì •ë§ ì¢‹ì€ ë°©ë²•ì¸ì§€ ì˜ ëª¨ë¥´ê² ë„¤ìš”...
        

### í•™ìŠµ ì¡°ê¸°ì¢…ë£Œì˜ í•´ì„ì  íŠ¹ì§•

L1ê³¼ L2 ì •ì¹™í™”ì—ì„œ ì†Œê°œí•œ ê²ƒì²˜ëŸ¼, ëª©ì í•¨ìˆ˜ $J(\boldsymbol w)$ì™€ ê·¸ê²ƒì´ ìµœì†Ÿê°’ì„ ê°€ì§€ê²Œ í•˜ëŠ” ì§€ì  $\boldsymbol w*$ì—ì„œ ì´ì°¨í•¨ìˆ˜ë¡œ ê·¼ì‚¬í•œ ìˆ˜ì‹  $\hat{J}(\boldsymbol w)$ë¥¼ ì‚´í´ë³´ì.

$$
\hat{J}(\boldsymbol w)=J(\boldsymbol w^\ast)+\frac{1}{2}(\boldsymbol w-\boldsymbol w^\ast)^{\text{T}}\boldsymbol H (\boldsymbol w-\boldsymbol w^\ast)
$$

ì—¬ê¸°ì—ì„œ $\boldsymbol H$ëŠ” $\boldsymbol w^\ast$ì—ì„œ í‰ê°€í•œ $J(\boldsymbol w)$ì˜ í—¤ì„¸ í–‰ë ¬ì´ë©°, $J(\boldsymbol w)$ê°€ $\boldsymbol w^\ast$ì—ì„œ ìµœì†Ÿê°’ì„ ê°€ì§ì´ ì •ì˜ë˜ì—ˆìœ¼ë¯€ë¡œ $\boldsymbol H$ëŠ” ì¤€ì •ë¶€í˜¸í–‰ë ¬(Positive Semi-Definite)ì´ë‹¤. ì´ë ‡ê²Œ ê·¼ì‚¬í•œ $\hat{J}$ì˜ GradientëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\nabla_{\boldsymbol w} \hat{J}(\boldsymbol w)=\boldsymbol H(\boldsymbol w-\boldsymbol w^\ast)
$$

ê·¸ëŸ¬ë©´ ê° ìŠ¤í… $\tau$ì—ì„œ íŒŒë¼ë¯¸í„° ì—…ë°ì´íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì´ë£¨ì–´ì§„ë‹¤.

$$
\begin{align*}
\boldsymbol w^{(\tau)}&= \boldsymbol w^{(\tau-1)}-\epsilon\nabla_{\boldsymbol w}\hat{J}(\boldsymbol w^{(\tau-1)})\\
&= \boldsymbol w^{(\tau-1)}-\epsilon\boldsymbol H(\boldsymbol w^{(\tau-1)}-\boldsymbol w^*)
\end{align*}
$$

ì´ ìˆ˜ì‹ì„ ì •ë¦¬í•˜ê³ , $\boldsymbol H$ì˜ ê³ ìœ³ê°’ ë¶„í•´ë¥¼ ì´ìš©í•˜ì—¬ $\boldsymbol H=\boldsymbol Q\boldsymbol \Lambda \boldsymbol Q^{\text{T}}$ë¥¼ ëŒ€ì…í•œë‹¤.

$$
\begin{align*}
\boldsymbol w^{(\tau)}-\boldsymbol w^\ast &=(\boldsymbol I -\epsilon\boldsymbol H)(\boldsymbol w^{(\tau-1)}-\boldsymbol w^\ast)\\
\boldsymbol w^{(\tau)}-\boldsymbol w^\ast &=(\boldsymbol I -\epsilon\boldsymbol Q\boldsymbol \Lambda \boldsymbol Q^{\text{T}})(\boldsymbol w^{(\tau-1)}-\boldsymbol w^\ast)\\
Q^{\text{T}}(\boldsymbol w^{(\tau)}-\boldsymbol w^\ast )&=(\boldsymbol I -\epsilon\boldsymbol \Lambda )Q^{\text{T}}(\boldsymbol w^{(\tau-1)}-\boldsymbol w^\ast))
\end{align*}
$$

í¸ì˜ìƒ ê²½ì‚¬í•˜ê°•ë²•ì„ ì›ì ì—ì„œ ì‹œì‘í–ˆë‹¤ê³  ê°€ì •í•˜ë©´, $\boldsymbol w^{(0)}=0$ì´ë‹¤. ë˜í•œ $\epsilon$ì€ ë§¤ìš° ì‘ì€ ìˆ˜ë¡œ ì„¤ì •í•˜ì—¬, $\|1-\epsilon \lambda _i\|<1$ì„ ë§Œì¡±í•œë‹¤ê³  ìƒê°í•´ ë³´ì. ê·¸ë ‡ë‹¤ë©´ ì„ì˜ì˜ $\tau$ì‹œì ì—ì„œ $\boldsymbol w$ì˜ ìœ„ì¹˜ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\boldsymbol Q^{\text{T}}\boldsymbol w^{(\tau)}=[\boldsymbol I-\textcolor{blue}{(\boldsymbol I-\epsilon\boldsymbol \Lambda)^{\tau}}]\boldsymbol Q^{\text{T}}\boldsymbol w^\ast \hspace{1.5cm}\text{Early stopping}
$$

### L2 ì •ì¹™í™”ì™€ì˜ ë¹„êµ

ê·¸ë¦¬ê³  ì´ê²ƒì„ L2 ì •ì¹™í™”ì—ì„œ ì‚´í´ë³´ì•˜ë˜, $\tilde{\boldsymbol w}$ì˜ ìˆ˜ì‹ê³¼ ë¹„êµí•´ ë³´ì. ë’¤ëŒì•„ë³´ìë©´, ì´ ìˆ˜ì‹ì€ ë§ˆì°¬ê°€ì§€ë¡œ ì›ë³¸ ëª©ì í•¨ìˆ˜ $J$ì™€ ê·¸ê²ƒì´ ìµœì†Ÿê°’ì„ ê°€ì§€ê²Œ í•˜ëŠ” ì  $\boldsymbol w^\ast$ì´ ì¡´ì¬í•  ë•Œ, $J$ë¥¼ $\boldsymbol w=\boldsymbol w^\ast$ì—ì„œ ì´ì°¨í•¨ìˆ˜ë¡œ ê·¼ì‚¬í•œ í•¨ìˆ˜ $\hat{J}$ë¥¼ L2 ì •ì¹™í™”í•œ ë’¤ ë‹¤ì‹œ ìµœì†Ÿê°’ì„ êµ¬í•œ ê²ƒì´ë‹¤.

$$
\begin{align*}
\boldsymbol{\tilde{w}}&=\boldsymbol{Q (\Lambda}+\alpha{\boldsymbol I})^{-1} {\boldsymbol \Lambda} {\boldsymbol Q}^{\text{T}}\boldsymbol{w}^\ast\\
\boldsymbol Q^{\text{T}}\boldsymbol{\tilde{w}}&=\boldsymbol{ (\Lambda}+\alpha{\boldsymbol I})^{-1} {\boldsymbol \Lambda} {\boldsymbol Q}^{\text{T}}\boldsymbol{w}^\ast
\\&=[\boldsymbol I-\textcolor{green}{(\boldsymbol \Lambda +\alpha\boldsymbol I)^{-1}\alpha}]\boldsymbol Q^\text{T}\boldsymbol w^\ast \hspace{1.5cm}\text{L2 Regularization}
\end{align*}
$$

ê·¸ë ‡ë‹¤ë©´ ë§Œì•½ í•˜ì´í¼íŒŒë¼ë¯¸í„° $\epsilon$, $\alpha$, $\tau$ê°€ $\textcolor{blue}{(\boldsymbol I-\epsilon\boldsymbol\Lambda)^\tau}=\textcolor{green}{(\boldsymbol\Lambda+\alpha\boldsymbol I)^{-1}\alpha}$ë¥¼ ë§Œì¡±í•˜ë„ë¡ ì„ íƒëœë‹¤ë©´, ë‘ ìˆ˜ì‹ì€ ìˆ˜í•™ì ìœ¼ë¡œ ë™ì¹˜ê°€ ëœë‹¤. ì–´ë–¤ ì‹œê°ì—ì„œëŠ” í•™ìŠµ ì¡°ê¸°ì¢…ë£Œê°€ L2 ì •ì¹™í™”ì˜ ì¼ë°˜í™”ì¼ ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤. ê·¸ëŸ¬ë‚˜ ë‘ ì •ì¹™í™” ë°©ì‹ì€ ë™ì¼ì„ ìƒì— ë†“ê¸° ì–´ë µë‹¤. ê²€ì¦ ë°ì´í„°ì…‹ì„ ë‘ê³  ì£¼ê¸°ì ìœ¼ë¡œ í‰ê°€í•œë‹¤ëŠ” íŠ¹ì„±ìƒ, í•™ìŠµ ì¡°ê¸°ì¢…ë£ŒëŠ” L2 ì •ì¹™í™”ë¥¼ í†µí•´ ì–»ì„ ìˆ˜ ìˆëŠ” ìµœì í•´ë³´ë‹¤ë„ ë” ì¢‹ì€ ì¼ë°˜í™” ì„±ëŠ¥ì„ ì œê³µí•˜ëŠ” sweet spotì„ ë°œê²¬í•  ìˆ˜ ìˆëŠ” ì ì¬ë ¥ì„ ê°€ì§€ê³  ìˆë‹¤.