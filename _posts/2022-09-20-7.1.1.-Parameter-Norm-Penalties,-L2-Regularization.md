---
math: true
title: "[DL Book] 7-1-1. Parameter Norm Penalties, L2 Regularization"
categories:
  - Deep Learning Book
tags:
  - Books
  - Deep Learning Book
  - Regularization
  - Statistics
  - Study Group
---

## 7.1.1. L2 νλΌλ―Έν„° μ •μΉ™ν™”
L2 νλΌλ―Έν„° μ •μΉ™ν™”λ” μ •μΉ™ν™” ν•­μ„ **λ¨λΈ νλΌλ―Έν„°μ— λ€ν• L2 λ…Έλ¦„μ μ κ³±μ μ λ°**μΌλ΅ μ‚Όλ” μ „λµμΌλ΅, λ”¥λ¬λ‹ μ΄μ „μ—λ„ **λ¦Ώμ§€ νκ·€** νΉμ€ **ν‹°νΈλ…Έν”„ μ •μΉ™ν™”**λΌλ” μ΄λ¦„μΌλ΅ μ΄λ―Έ λ„λ¦¬ μ•λ ¤μ΅λ‹¤. νΈμλ¥Ό μ„ν•΄ νΈν–¥ νλΌλ―Έν„°κ°€ μ—†λ” λ¨λΈμ λ©μ ν•¨μ $J$μ™€ L2 μ •μΉ™ν™”κ°€ μ μ©λ λ©μ ν•¨μ $\hat{J}$λ¥Ό μƒκ°ν•΄ λ³΄μ.

$$
\begin{align*}
\Omega(w)&=\color{red}{\frac{1}{2}\|w\|^2_2}\\
\tilde{J}(w;X,y) &=J(w;X,y) + \color{red}{\alpha(\frac{1}{2}\|w\|^2_2)}\\
&=J(w;X,y) + \color{red}{\frac{\alpha}{2}w^\text{T}w}
\end{align*}
$$

μ΄ κ²½μ° νλΌλ―Έν„° $w$μ— λ€ν• gradientλ” λ‹¤μκ³Ό κ°™μ΄ μ£Όμ–΄μ§„λ‹¤.

$$
\nabla_w\tilde{J}(w;X,y)=\nabla_w J(w;X,y)+\color{red}{\alpha w}
$$

κ·Έλ ‡λ‹¤λ©΄ ν•™μµλ¥  $\epsilon$κ°€ μ£Όμ–΄μ΅μ„ λ• κ° λ‹¨κ³„μ κ°€μ¤‘μΉ κ°±μ‹  κ·μΉ™μ€ λ‹¤μκ³Ό κ°™λ‹¤.

$$
\begin{align*}
&w \leftarrow w-\epsilon(\textcolor{red}{\alpha w}+\nabla_wJ(w;X,y))\\
&w\leftarrow (1-\epsilon \textcolor{red}{\alpha})w-\epsilon\nabla_wJ(w;X,y)
\end{align*}
$$

μ •μΉ™ν™”λ¥Ό μ μ©ν•μ§€ μ•μ€ κ°±μ‹  κ·μΉ™κ³Ό λΉ„κµν•΄ λ³΄λ©΄ κ·Έ μ°¨μ΄κ°€ ν™•μ—°ν λ“λ¬λ‚λ‹¤.

$$
\begin{align*}
w&\leftarrow \hspace{2.1cm} w-\epsilon\nabla_wJ(w;X,y)
\hspace{0.5cm}&\text{unregularized}\\
w&\leftarrow (1-\epsilon \textcolor{red}{\alpha})w-\epsilon\nabla_wJ(w;X,y)
&\text{L2 regularized}
\end{align*}
$$

μ¦‰ $\alpha$λ” κ°€μ¤‘μΉκ°€ κ°±μ‹ λ  λ•λ§λ‹¤, gradientλ¥Ό μ μ©ν•κΈ° μ§μ „μ— κ°€μ¤‘μΉμ ν¬κΈ°λ¥Ό μ¤„μ—¬ μ£Όλ” μ—­ν• μ„ ν•¨μ„ ν™•μΈν•  μ μλ‹¤. **μ •ν™•νλ” μ–‘μ, μμλ¥Ό λ¶λ¬Έν•κ³  κ°€μ¤‘μΉμ μ λ“κ°’μ„ μ‘κ² λ§λ“ λ‹¤.**

### ν•μ΄νΌνλΌλ―Έν„° $\boldsymbol \alpha$ κ°’μ μ¤‘μ”μ„±

μ΄λ²μ—λ” $\boldsymbol w^\ast$μ—μ„ λ©μ ν•¨μ $J(\theta)$κ°€ μµμ†κ°’μ„ κ°€μ§„λ‹¤κ³  κ°€μ •ν•κ³ , ν…μΌλ¬ κΈ‰μλ¥Ό μ΄μ©ν•΄ $J(\theta)$λ¥Ό λ¶„ν•΄ν•΄ λ³΄μ. ν…μΌλ¬ κΈ‰μμ μ „κ°λ” λ¬΄ν•ν κ³„μ†λ  μ μμ§€λ§ 2μ°¨ν•­κΉμ§€λ§ μ‚¬μ©ν•λ‹¤. μ΄κ²ƒμ„ Quadratic Approximationμ΄λΌκ³  ν•λ‹¤.

$$
\begin{align*}
f(x)&=\sum^n_{k=0}\frac{f^{(k)}(a)}{k!}(x-a)^k \hspace{3.5cm}\text{Taylor Expansion} \\
 &\approx f(a)+f'(a)(x-a)+\frac{1}{2!}f''(a)(x-a)^2+\textcolor{gray}{\frac{1}{3!}f'''(a)(x-a)^3 \cdots}
\end{align*}
$$

λ©μ ν•¨μ $J(\theta)$λ¥Ό, μµμ†κ°’μ„ κ°€μ§€κ² ν•λ” μ§€μ  $\boldsymbol w^*$μ—μ„ 2μ°¨ λ‹¤ν•­ν•¨μλ΅ κ·Όμ‚¬ν•λ©΄ λ‹¤μκ³Ό κ°™λ‹¤. 

$$
\hat{J}(\theta)=J({\boldsymbol w}^\ast)+\color{lightgray}{J'(\boldsymbol{w^*})(\boldsymbol{w}-\boldsymbol{w}^\ast)+}\frac{1}{2}(\boldsymbol{w}-\boldsymbol{w}^\ast)\boldsymbol{H}(\boldsymbol{w}-\boldsymbol{w}^\ast)
$$

2μ°¨ λ‹¤ν•­ν•¨μ κ·Όμ‚¬μ—μ„λ” μΌλ°μ μΌλ΅ ν•¨μ μ›ν•κ³Ό 1μ°¨, 2μ°¨ λ„ν•¨μκ°€ ν¬ν•¨λ ν•­μ„ λ‚¨κΈ°λ”λ°, μ •μμƒ $\boldsymbol{w}^\ast$λ” μµμ†κ°’μ΄λ―€λ΅ $\boldsymbol{w}^\ast$μ—μ„μ 1μ°¨ λ„ν•¨μλ” 0μ΄ λλ‹¤. λν• μµμ†κ°’μ΄ μ΅΄μ¬ν•¨μ΄ μ „μ λλ―€λ΅ **$\boldsymbol H$λ” Positive Semi-Definite**μ΄μ–΄μ•Ό ν•λ‹¤.

κ·Έλ¬λ©΄ κ·Όμ‚¬ λ©μ ν•¨μ $\hat{J}(\theta)$λ” κ·Έ λ―Έλ¶„μ΄ 0μ΄ λλ” κ³³μ—μ„ μµμ†κ°’μ„ κ°€μ§„λ‹¤. 

$$
\nabla_{\boldsymbol w}\hat{J}(\theta) = \boldsymbol{H}(\boldsymbol{w}-\boldsymbol{w}^\ast)=0
$$

μ—¬κΈ°μ„ μ •μΉ™ν™” ν•­ $\Omega(\theta)=\frac{1}{2}\|\|\theta\|\|^2_2$ λ¥Ό λ„μ…ν•λ‹¤κ³  μƒκ°ν•΄ λ³΄μ. κ·Έλ ‡λ‹¤λ©΄ λ°©κΈ κ³„μ‚°ν• λ―Έλ¶„κ°’μ— μ •μΉ™ν™” ν•­μ λ―Έλ¶„κ°’μ„ λ”ν•΄μ£Όμ–΄μ•Ό ν•λ‹¤. κ·Έ ν›„, μμ‹μ„ 0μΌλ΅ λ§λ“λ” $\boldsymbol{w}$λ¥Ό μ°ΎμΌλ©΄ λ‹¤μκ³Ό κ°™λ‹¤.

$$
\begin{align*}
\boldsymbol{H}(\boldsymbol{w}-\boldsymbol{w}^\ast)+\textcolor{red}{\alpha\boldsymbol{w}} &=0\\

(\boldsymbol{H}+\textcolor{red}{\alpha\boldsymbol{I}})\tilde{\boldsymbol{w}}&=\boldsymbol{H}\boldsymbol{w}^\ast\\

\tilde{\boldsymbol{w}}&=(\boldsymbol{H}+\textcolor{red}{\alpha\boldsymbol{I}})^{-1}\boldsymbol{H}\boldsymbol{w}^\ast
\end{align*}
$$

μ—¬κΈ°μ„ μ°μ„ μ μΌλ΅ ν™•μΈν•  μ μλ” κ²ƒμ€, $\alpha$κ°€ 0μ— λ¬΄ν•ν κ°€κΉμ›μ§μλ΅ μ •μΉ™ν™”μ ν¨κ³Όκ°€ μ‚¬λΌμ§€λ©°, κ²°κµ­ μ •μΉ™ν™”λ λ©μ ν•¨μμ μµμ ν™” ν•΄λ” $\tilde{\boldsymbol{w}}=\boldsymbol{HH^{-1}}\boldsymbol{w}^\ast$κ°€ λμ–΄, μ •μΉ™ν™”λμ§€ μ•μ€ λ©μ ν•¨μμ μµμ†κ°’μΌλ΅ μ •μλ $\boldsymbol{w}^\ast$ μ™€ κ°™μ•„μ§„λ‹¤λ” κ²ƒμ΄λ‹¤.

### ν•μ΄νΌνλΌλ―Έν„° $\boldsymbol \alpha$ κ°’μ μλ―Έ

κ³„μ†ν•΄μ„ $\boldsymbol{H}$λ” ν—¤μ‹μ• ν–‰λ ¬λ΅ λ€μΉ­ν–‰λ ¬μ΄λ©°, κ³ μ³κ°’ λ¶„ν•΄κ°€ κ°€λ¥ν•λ‹¤. $\boldsymbol{H=Q\Lambda Q}^{\text{T}}$λ΅ κ³ μ³κ°’ λ¶„ν•΄λ¥Ό μ§„ν–‰ν•κ³  μμ‹μ„ μ •λ¦¬ν•λ©΄,

$$
\begin{align*}
\boldsymbol{\tilde{w}}&=(\boldsymbol{Q\Lambda Q}^{\text{T}}+\alpha\boldsymbol{I})^{-1}\boldsymbol{Q\Lambda Q}^{\text{T}}\boldsymbol{w}^\ast\\
&=\bigg[\boldsymbol{Q(\Lambda}+\alpha {\boldsymbol I}) \boldsymbol{Q}^{\text{T}}\bigg]^{-1}\boldsymbol{Q\Lambda Q}^{\text{T}}\boldsymbol{w}^\ast\\
&=\color{blue}{\boldsymbol Q}\color{green}{(\Lambda}\color{green}{+\alpha{\boldsymbol I})^{-1} {\boldsymbol \Lambda}}\color{blue}{\boldsymbol Q^{\text{T}}}\boldsymbol{w}^\ast
\end{align*}
$$

κ³ μ³κ°’ λ¶„ν•΄μ $\boldsymbol{\color{blue}Q\color{green}\Lambda \color{blue}{Q^{\text{T}}}}$μ κ° ν–‰λ ¬μ€ κ°κ° **νμ „β†’ν¬κΈ°λ³€ν™β†’νμ „**μ κ³Όμ •μ„ λ‚νƒ€λ‚Έ κ²ƒμΌλ΅ ν•΄μ„ν•  μ μλ‹¤. μ—¬κΈ°μ—μ„ L2 μ •μΉ™ν™”μ ν¨κ³Όλ¥Ό μ—Ώλ³Ό μ μλ‹¤. 

{: .highlight }
> \\
> **π’΅ μμ„Έν λ³΄κΈ°**:
>
> **L2 μ •μΉ™ν™”λ¥Ό μ μ©ν•λ©΄ κΈ°μ΅΄ μµμ ν™” ν•΄ $\boldsymbol w^\ast$κ°€ μƒλ΅μ΄ μ  $\tilde{\boldsymbol w}$λ΅ μ΄λ™ν•λ‹¤.**
>  - κΈ°μ΅΄ μµμ ν™” ν•΄ $\boldsymbol w^\ast$λ” $\boldsymbol H$μ κ³ μ λ²΅ν„°μ λ°©ν–¥μΌλ΅ μ„ ν•λ³€ν™λλ©°, κ·Έ ν¬κΈ°κ°€ μ΅°μ λλ” μ •λ„λ” $\boldsymbol H$μ κ³ μ³κ°’λ“¤κ³Ό μ—°κ΄€μ΄ μλ‹¤.
>  - L2 μ •μΉ™ν™”λ¥Ό μ‹ν–‰ν•λ©΄ κ³ μ³κ°’λ“¤μ— $\alpha$λ§νΌμ μƒμκ°€ λ”ν•΄μ§„λ‹¤. λ”°λΌμ„,
>      - $\alpha$λ³΄λ‹¤ μ‘μ€ κ³ μ³κ°’λ“¤μ€ κ·Έλ§νΌ μν–¥μ„ λ§μ΄ λ°›λ”λ‹¤. μ¦‰ ν•΄λ‹Ή κ³ μ λ²΅ν„° λ°©ν–¥μΌλ΅λ” ν° λ³€ν™μ΄ μΌμ–΄λ‚λ‹¤.
>      - $\alpha$λ³΄λ‹¤ ν° κ³ μ³κ°’λ“¤μ€ λΉ„κµμ  μν–¥μ„ λ λ°›λ”λ‹¤. μ¦‰ ν•΄λ‹Ή κ³ μ λ²΅ν„° λ°©ν–¥μΌλ΅λ” μ‘μ€ λ³€ν™λ§μ΄ μΌμ–΄λ‚λ‹¤.


### L2 μ •μΉ™ν™”μ κΈ°ν•ν•™μ  μλ―Έ

![Untitled](/assets/images/dlbook/7/3.png)

μ„ κ·Έλ¦Όμ—μ„ $\boldsymbol w^\ast$λ” μ›λ³Έ λ©μ ν•¨μ $J$λ¥Ό μµμ†ν™”μ‹ν‚¤λ” μ§€μ μ΄κ³ , μ›μ  $(0, 0)$μ€ μ •μΉ™ν™” ν•­ $\alpha \times \frac{1}{2}\|\|\boldsymbol w\|\|^2_2$ λ¥Ό μµμ†ν™”μ‹ν‚¤λ” μ§€μ μ΄λ‹¤. L2 μ •μΉ™ν™”λ λ©μ ν•¨μ $\hat{J}$λ” μ–‘μ½ λ¨λ‘λ¥Ό μµμ†ν™”μ‹μΌμ•Ό ν•λ―€λ΅, λ‘ ν•¨μκ°€ μ μ  λ°”κΉ¥μΌλ΅ λ»—μ–΄λ‚κ°€λ‹¤κ°€ λ§λ‚λ” μ§€μ μ—μ„ μµμ†κ°’μ„ κ°€μ§€κ² λλ‹¤.